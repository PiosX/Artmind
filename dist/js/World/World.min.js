function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_toPropertyKey(r.key),r)}}function _createClass(e,t,o){return t&&_defineProperties(e.prototype,t),o&&_defineProperties(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){e=_toPrimitive(e,"string");return"symbol"===_typeof(e)?e:String(e)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0===o)return("string"===t?String:Number)(e);o=o.call(e,t||"default");if("object"!==_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}import{Vector2}from"../../../../node_modules/three/build/three.module.js";import{createCamera}from"./components/camera.min.js";import{createCube}from"./components/cube.min.js";import{createScene}from"./components/scene.min.js";import{createControls}from"./systems/controls.min.js";import{createRenderer}from"./systems/renderer.min.js";import{Resizer}from"./systems/Resizer.min.js";import{Loop}from"./systems/Loop.min.js";import{CurtainShader}from"./components/effect.min.js";import{RGBAShader}from"./components/effect2.min.js";import{EffectComposer}from"https://cdn.skypack.dev/three@0.128.0/examples/jsm/postprocessing/EffectComposer.js";import{RenderPass}from"https://cdn.skypack.dev/three@0.128.0/examples/jsm/postprocessing/RenderPass.js";import{ShaderPass}from"https://cdn.skypack.dev/three@0.128.0/examples/jsm/postprocessing/ShaderPass.js";import{GUI}from"./../../../node_modules/dat.gui/build/dat.gui.module.js";import{gsap}from"./../../../node_modules/gsap/index.js";var renderer,scene,loop,mouse=new Vector2,target=new Vector2,windowHalf=new Vector2(window.innerWidth/2,window.innerHeight/2),camera=createCamera(),cube=createCube(),World=function(){function t(e){_classCallCheck(this,t),renderer=createRenderer(),scene=createScene(),loop=new Loop(camera,scene,renderer),e.append(renderer.domElement),this.initPost(),this.render(),cube.groups.forEach(function(e){scene.add(e)}),this.time=0,this.mouse=new Vector2,this.target=new Vector2,this.windowHalf=new Vector2(window.innerWidth/2,window.innerHeight/2),document.addEventListener("mousemove",this.onMouseMove,!1),this.resizer=new Resizer(e,camera,renderer,this.composer),this.settings()}return _createClass(t,[{key:"settings",value:function(){var t=this;this.settings={progress:0,progress1:0,runAnimation:function(){t.runAnimation()}},this.gui=new GUI,this.gui.add(this.settings,"progress",0,1,.01),this.gui.add(this.settings,"progress1",0,1,.01).onChange(function(e){t.effectPass.uniforms.uProgress.value=e}),this.gui.add(this.settings,"runAnimation")}},{key:"runAnimation",value:function(){var e=gsap.timeline();e.to(camera.position,{x:camera.position.x+2500,duration:1.5,ease:"power4.inOut"}),e.to(camera.position,{z:700,duration:1,ease:"power4.inOut"},0),e.to(camera.position,{z:900,duration:1,ease:"power4.inOut"},1),e.to(this.effectPass.uniforms.uProgress,{value:1,duration:1,ease:"power3,inOut"},0),e.to(this.effectPass.uniforms.uProgress,{value:0,duration:1,ease:"power3,inOut"},1),e.to(this.effectPass1.uniforms.uProgress,{value:1,duration:1,ease:"power3,inOut"},0),e.to(this.effectPass1.uniforms.uProgress,{value:0,duration:1,ease:"power3,inOut"},1)}},{key:"initPost",value:function(){this.composer=new EffectComposer(renderer);var e=new RenderPass(scene,camera);this.composer.addPass(e),this.effectPass=new ShaderPass(CurtainShader),this.composer.addPass(this.effectPass),this.effectPass1=new ShaderPass(RGBAShader),this.composer.addPass(this.effectPass1)}},{key:"onMouseMove",value:function(e){mouse.x=e.clientX-windowHalf.x,mouse.y=e.clientY-windowHalf.x}},{key:"render",value:function(){var o=this;requestAnimationFrame(this.render.bind(this)),this.time+=.05,this.oscilator=.5*Math.sin(.1*this.time)+.5,renderer.setAnimationLoop(function(){cube.groups.forEach(function(e){target.x=15e-5*(1-mouse.x),target.y=14e-5*(-500-mouse.y),e.rotation.x+=.05*(target.y-e.rotation.x),e.rotation.y+=.05*(target.x-e.rotation.y),e.children.forEach(function(e,t){e.position.z=100*(t+1)-200*o.oscilator})}),o.composer.render()})}},{key:"start",value:function(){loop.start()}},{key:"stop",value:function(){loop.stop()}}]),t}();export{World};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIldvcmxkL1dvcmxkLmpzIl0sIm5hbWVzIjpbIlZlY3RvcjIiLCJjcmVhdGVDYW1lcmEiLCJjcmVhdGVDdWJlIiwiY3JlYXRlU2NlbmUiLCJjcmVhdGVDb250cm9scyIsImNyZWF0ZVJlbmRlcmVyIiwiUmVzaXplciIsIkxvb3AiLCJDdXJ0YWluU2hhZGVyIiwiUkdCQVNoYWRlciIsInJlbmRlcmVyIiwic2NlbmUiLCJsb29wIiwid2luZG93IiwiaW5uZXJXaWR0aCIsImlubmVySGVpZ2h0IiwibW91c2UiLCJ0YXJnZXQiLCJjYW1lcmEiLCJXb3JsZCIsIl9jbGFzc0NhbGxDaGVjayIsInRoaXMiLCJjb250YWluZXIiLCJhcHBlbmQiLCJjdWJlIiwiaW5pdFBvc3QiLCJhZGQiLCJ3aW5kb3dIYWxmIiwiZG9jdW1lbnQiLCJzZXR0aW5ncyIsIm9uTW91c2VNb3ZlIiwicmVzaXplciIsImNvbXBvc2VyIiwiX2NyZWF0ZUNsYXNzIiwia2V5IiwidmFsdWUiLCJ0aGF0IiwicHJvZ3Jlc3MiLCJwcm9ncmVzczEiLCJydW5BbmltYXRpb24iLCJfdGhpcyIsImd1aSIsImVmZmVjdFBhc3MiLCJ1bmlmb3JtcyIsInZhbCIsIm9uQ2hhbmdlIiwidVByb2dyZXNzIiwidGwiLCJnc2FwIiwidGltZWxpbmUiLCJ0byIsIngiLCJwb3NpdGlvbiIsImR1cmF0aW9uIiwiZWFzZSIsInoiLCJyZW5kZXJQYXNzIiwiZWZmZWN0UGFzczEiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJ0aW1lIiwiY2hpbGRyZW4iLCJpIiwiUmVuZGVyUGFzcyIsImFkZFBhc3MiLCJTaGFkZXJQYXNzIiwic3RhcnQiLCJldmVudCIsImNsaWVudFgiLCJ5IiwiY2xpZW50WSIsIl90aGlzMiIsInJlbmRlciIsImJpbmQiLCJvc2NpbGF0b3IiLCJNYXRoIiwic2luIiwic2V0QW5pbWF0aW9uTG9vcCIsImdyb3VwcyIsImZvckVhY2giLCJpdGVtIiwicm90YXRpb24iLCJtIiwic3RvcCJdLCJtYXBwaW5n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LEtBQUFDLElBQUEsR0FBQXRELEtBQUFzQyxJQUFBLEVBQUEsR0F2QkFqRCxTQUFTa0UsaUJBQWlCLFdBQ3pCcEQsS0FBS3FELE9BQU9DLFFBQVEsU0FBQ0MsR0FDcEI5RCxPQUFPa0MsRUFBb0IsT0FBZixFQUFJbkMsTUFBTW1DLEdBQ3RCbEMsT0FBT21ELEVBQXVCLE9BQWxCLENBQUMsSUFBTXBELE1BQU1vRCxHQUN6QlcsRUFBS0MsU0FBUzdCLEdBQUssS0FBUWxDLE9BQU9tRCxFQUFJVyxFQUFLQyxTQUFTN0IsR0FDcEQ0QixFQUFLQyxTQUFTWixHQUFLLEtBQVFuRCxPQUFPa0MsRUFBSTRCLEVBQUtDLFNBQVNaLEdBRXBEVyxFQUFLbkIsU0FBU2tCLFFBQVEsU0FBQ0csRUFBR3BCLEdBQ3pCb0IsRUFBRTdCLFNBQVNHLEVBQWMsS0FBVE0sRUFBSSxHQUE0QixJQUFqQlMsRUFBS0csU0FDckMsQ0FBQyxDQUNGLENBQUMsRUFFREgsRUFBS3RDLFNBQVN1QyxPQUFNLENBQ3JCLENBQUMsQ0FFRixDQUFDLEVBQUEsQ0FBQXJDLElBQUEsUUFBQUMsTUFFRCxXQUNDdkIsS0FBS3FELE1BQUssQ0FDWCxDQUFDLEVBQUEsQ0FBQS9CLElBQUEsT0FBQUMsTUFFRCxXQUNDdkIsS0FBS3NFLEtBQUksQ0FDVixDQUFDLEVBQUEsRUFBQS9ELENBQUEsRUFBQSxTQUdPQSxLQUFLIiwiZmlsZSI6IldvcmxkL1dvcmxkLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFZlY3RvcjIgfSBmcm9tIFwiLi4vLi4vLi4vLi4vbm9kZV9tb2R1bGVzL3RocmVlL2J1aWxkL3RocmVlLm1vZHVsZS5qc1wiO1xyXG5pbXBvcnQgeyBjcmVhdGVDYW1lcmEgfSBmcm9tIFwiLi9jb21wb25lbnRzL2NhbWVyYS5taW4uanNcIjtcclxuaW1wb3J0IHsgY3JlYXRlQ3ViZSB9IGZyb20gXCIuL2NvbXBvbmVudHMvY3ViZS5taW4uanNcIjtcclxuaW1wb3J0IHsgY3JlYXRlU2NlbmUgfSBmcm9tIFwiLi9jb21wb25lbnRzL3NjZW5lLm1pbi5qc1wiO1xyXG5cclxuaW1wb3J0IHsgY3JlYXRlQ29udHJvbHMgfSBmcm9tIFwiLi9zeXN0ZW1zL2NvbnRyb2xzLm1pbi5qc1wiO1xyXG5pbXBvcnQgeyBjcmVhdGVSZW5kZXJlciB9IGZyb20gXCIuL3N5c3RlbXMvcmVuZGVyZXIubWluLmpzXCI7XHJcbmltcG9ydCB7IFJlc2l6ZXIgfSBmcm9tIFwiLi9zeXN0ZW1zL1Jlc2l6ZXIubWluLmpzXCI7XHJcbmltcG9ydCB7IExvb3AgfSBmcm9tIFwiLi9zeXN0ZW1zL0xvb3AubWluLmpzXCI7XHJcbmltcG9ydCB7IEN1cnRhaW5TaGFkZXIgfSBmcm9tIFwiLi9jb21wb25lbnRzL2VmZmVjdC5taW4uanNcIjtcclxuaW1wb3J0IHsgUkdCQVNoYWRlciB9IGZyb20gXCIuL2NvbXBvbmVudHMvZWZmZWN0Mi5taW4uanNcIjtcclxuaW1wb3J0IHsgRWZmZWN0Q29tcG9zZXIgfSBmcm9tIFwiaHR0cHM6Ly9jZG4uc2t5cGFjay5kZXYvdGhyZWVAMC4xMjguMC9leGFtcGxlcy9qc20vcG9zdHByb2Nlc3NpbmcvRWZmZWN0Q29tcG9zZXIuanNcIjtcclxuaW1wb3J0IHsgUmVuZGVyUGFzcyB9IGZyb20gXCJodHRwczovL2Nkbi5za3lwYWNrLmRldi90aHJlZUAwLjEyOC4wL2V4YW1wbGVzL2pzbS9wb3N0cHJvY2Vzc2luZy9SZW5kZXJQYXNzLmpzXCI7XHJcbmltcG9ydCB7IFNoYWRlclBhc3MgfSBmcm9tIFwiaHR0cHM6Ly9jZG4uc2t5cGFjay5kZXYvdGhyZWVAMC4xMjguMC9leGFtcGxlcy9qc20vcG9zdHByb2Nlc3NpbmcvU2hhZGVyUGFzcy5qc1wiO1xyXG5pbXBvcnQgeyBHVUkgfSBmcm9tIFwiLi8uLi8uLi8uLi9ub2RlX21vZHVsZXMvZGF0Lmd1aS9idWlsZC9kYXQuZ3VpLm1vZHVsZS5qc1wiO1xyXG5pbXBvcnQgeyBnc2FwIH0gZnJvbSBcIi4vLi4vLi4vLi4vbm9kZV9tb2R1bGVzL2dzYXAvaW5kZXguanNcIjtcclxuXHJcbmxldCByZW5kZXJlcjtcclxubGV0IHNjZW5lO1xyXG5sZXQgbG9vcDtcclxuXHJcbmxldCBtb3VzZSA9IG5ldyBWZWN0b3IyKCk7XHJcbmxldCB0YXJnZXQgPSBuZXcgVmVjdG9yMigpO1xyXG5sZXQgd2luZG93SGFsZiA9IG5ldyBWZWN0b3IyKHdpbmRvdy5pbm5lcldpZHRoIC8gMiwgd2luZG93LmlubmVySGVpZ2h0IC8gMik7XHJcbmxldCBjYW1lcmEgPSBjcmVhdGVDYW1lcmEoKTtcclxubGV0IGN1YmUgPSBjcmVhdGVDdWJlKCk7XHJcblxyXG5jbGFzcyBXb3JsZCB7XHJcblx0Y29uc3RydWN0b3IoY29udGFpbmVyKSB7XHJcblx0XHRyZW5kZXJlciA9IGNyZWF0ZVJlbmRlcmVyKCk7XHJcblx0XHRzY2VuZSA9IGNyZWF0ZVNjZW5lKCk7XHJcblx0XHRsb29wID0gbmV3IExvb3AoY2FtZXJhLCBzY2VuZSwgcmVuZGVyZXIpO1xyXG5cdFx0Y29udGFpbmVyLmFwcGVuZChyZW5kZXJlci5kb21FbGVtZW50KTtcclxuXHRcdHRoaXMuaW5pdFBvc3QoKTtcclxuXHRcdHRoaXMucmVuZGVyKCk7XHJcblx0XHRjdWJlLmdyb3Vwcy5mb3JFYWNoKChpdGVtKSA9PiB7XHJcblx0XHRcdHNjZW5lLmFkZChpdGVtKTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdHRoaXMudGltZSA9IDA7XHJcblxyXG5cdFx0Ly8gY29uc3QgY29udHJvbHMgPSBjcmVhdGVDb250cm9scyhjYW1lcmEsIHJlbmRlcmVyLmRvbUVsZW1lbnQpO1xyXG5cdFx0Ly8gbG9vcC51cGRhdGFibGVzLnB1c2goY29udHJvbHMpO1xyXG5cclxuXHRcdHRoaXMubW91c2UgPSBuZXcgVmVjdG9yMigpO1xyXG5cdFx0dGhpcy50YXJnZXQgPSBuZXcgVmVjdG9yMigpO1xyXG5cdFx0dGhpcy53aW5kb3dIYWxmID0gbmV3IFZlY3RvcjIoXHJcblx0XHRcdHdpbmRvdy5pbm5lcldpZHRoIC8gMixcclxuXHRcdFx0d2luZG93LmlubmVySGVpZ2h0IC8gMlxyXG5cdFx0KTtcclxuXHJcblx0XHRkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsIHRoaXMub25Nb3VzZU1vdmUsIGZhbHNlKTtcclxuXHRcdHRoaXMucmVzaXplciA9IG5ldyBSZXNpemVyKGNvbnRhaW5lciwgY2FtZXJhLCByZW5kZXJlciwgdGhpcy5jb21wb3Nlcik7XHJcblxyXG5cdFx0dGhpcy5zZXR0aW5ncygpO1xyXG5cdH1cclxuXHJcblx0c2V0dGluZ3MoKSB7XHJcblx0XHRsZXQgdGhhdCA9IHRoaXM7XHJcblx0XHR0aGlzLnNldHRpbmdzID0ge1xyXG5cdFx0XHRwcm9ncmVzczogMCxcclxuXHRcdFx0cHJvZ3Jlc3MxOiAwLFxyXG5cdFx0XHRydW5BbmltYXRpb246ICgpID0+IHtcclxuXHRcdFx0XHR0aGlzLnJ1bkFuaW1hdGlvbigpO1xyXG5cdFx0XHR9LFxyXG5cdFx0fTtcclxuXHRcdHRoaXMuZ3VpID0gbmV3IEdVSSgpO1xyXG5cdFx0dGhpcy5ndWkuYWRkKHRoaXMuc2V0dGluZ3MsIFwicHJvZ3Jlc3NcIiwgMCwgMSwgMC4wMSk7XHJcblx0XHR0aGlzLmd1aS5hZGQodGhpcy5zZXR0aW5ncywgXCJwcm9ncmVzczFcIiwgMCwgMSwgMC4wMSkub25DaGFuZ2UoKHZhbCkgPT4ge1xyXG5cdFx0XHR0aGlzLmVmZmVjdFBhc3MudW5pZm9ybXMudVByb2dyZXNzLnZhbHVlID0gdmFsO1xyXG5cdFx0fSk7XHJcblx0XHR0aGlzLmd1aS5hZGQodGhpcy5zZXR0aW5ncywgXCJydW5BbmltYXRpb25cIik7XHJcblx0fVxyXG5cclxuXHRydW5BbmltYXRpb24oKSB7XHJcblx0XHRsZXQgdGwgPSBnc2FwLnRpbWVsaW5lKCk7XHJcblxyXG5cdFx0dGwudG8oY2FtZXJhLnBvc2l0aW9uLCB7XHJcblx0XHRcdHg6IGNhbWVyYS5wb3NpdGlvbi54ICsgMjUwMCxcclxuXHRcdFx0ZHVyYXRpb246IDEuNSxcclxuXHRcdFx0ZWFzZTogXCJwb3dlcjQuaW5PdXRcIixcclxuXHRcdH0pO1xyXG5cclxuXHRcdHRsLnRvKFxyXG5cdFx0XHRjYW1lcmEucG9zaXRpb24sXHJcblx0XHRcdHtcclxuXHRcdFx0XHR6OiA3MDAsXHJcblx0XHRcdFx0ZHVyYXRpb246IDEsXHJcblx0XHRcdFx0ZWFzZTogXCJwb3dlcjQuaW5PdXRcIixcclxuXHRcdFx0fSxcclxuXHRcdFx0MFxyXG5cdFx0KTtcclxuXHRcdHRsLnRvKFxyXG5cdFx0XHRjYW1lcmEucG9zaXRpb24sXHJcblx0XHRcdHtcclxuXHRcdFx0XHR6OiA5MDAsXHJcblx0XHRcdFx0ZHVyYXRpb246IDEsXHJcblx0XHRcdFx0ZWFzZTogXCJwb3dlcjQuaW5PdXRcIixcclxuXHRcdFx0fSxcclxuXHRcdFx0MVxyXG5cdFx0KTtcclxuXHJcblx0XHR0bC50byhcclxuXHRcdFx0dGhpcy5lZmZlY3RQYXNzLnVuaWZvcm1zLnVQcm9ncmVzcyxcclxuXHRcdFx0e1xyXG5cdFx0XHRcdHZhbHVlOiAxLFxyXG5cdFx0XHRcdGR1cmF0aW9uOiAxLFxyXG5cdFx0XHRcdGVhc2U6IFwicG93ZXIzLGluT3V0XCIsXHJcblx0XHRcdH0sXHJcblx0XHRcdDBcclxuXHRcdCk7XHJcblx0XHR0bC50byhcclxuXHRcdFx0dGhpcy5lZmZlY3RQYXNzLnVuaWZvcm1zLnVQcm9ncmVzcyxcclxuXHRcdFx0e1xyXG5cdFx0XHRcdHZhbHVlOiAwLFxyXG5cdFx0XHRcdGR1cmF0aW9uOiAxLFxyXG5cdFx0XHRcdGVhc2U6IFwicG93ZXIzLGluT3V0XCIsXHJcblx0XHRcdH0sXHJcblx0XHRcdDFcclxuXHRcdCk7XHJcblxyXG5cdFx0dGwudG8oXHJcblx0XHRcdHRoaXMuZWZmZWN0UGFzczEudW5pZm9ybXMudVByb2dyZXNzLFxyXG5cdFx0XHR7XHJcblx0XHRcdFx0dmFsdWU6IDEsXHJcblx0XHRcdFx0ZHVyYXRpb246IDEsXHJcblx0XHRcdFx0ZWFzZTogXCJwb3dlcjMsaW5PdXRcIixcclxuXHRcdFx0fSxcclxuXHRcdFx0MFxyXG5cdFx0KTtcclxuXHRcdHRsLnRvKFxyXG5cdFx0XHR0aGlzLmVmZmVjdFBhc3MxLnVuaWZvcm1zLnVQcm9ncmVzcyxcclxuXHRcdFx0e1xyXG5cdFx0XHRcdHZhbHVlOiAwLFxyXG5cdFx0XHRcdGR1cmF0aW9uOiAxLFxyXG5cdFx0XHRcdGVhc2U6IFwicG93ZXIzLGluT3V0XCIsXHJcblx0XHRcdH0sXHJcblx0XHRcdDFcclxuXHRcdCk7XHJcblx0fVxyXG5cclxuXHRpbml0UG9zdCgpIHtcclxuXHRcdHRoaXMuY29tcG9zZXIgPSBuZXcgRWZmZWN0Q29tcG9zZXIocmVuZGVyZXIpO1xyXG5cclxuXHRcdGNvbnN0IHJlbmRlclBhc3MgPSBuZXcgUmVuZGVyUGFzcyhzY2VuZSwgY2FtZXJhKTtcclxuXHRcdHRoaXMuY29tcG9zZXIuYWRkUGFzcyhyZW5kZXJQYXNzKTtcclxuXHJcblx0XHR0aGlzLmVmZmVjdFBhc3MgPSBuZXcgU2hhZGVyUGFzcyhDdXJ0YWluU2hhZGVyKTtcclxuXHRcdHRoaXMuY29tcG9zZXIuYWRkUGFzcyh0aGlzLmVmZmVjdFBhc3MpO1xyXG5cdFx0dGhpcy5lZmZlY3RQYXNzMSA9IG5ldyBTaGFkZXJQYXNzKFJHQkFTaGFkZXIpO1xyXG5cdFx0dGhpcy5jb21wb3Nlci5hZGRQYXNzKHRoaXMuZWZmZWN0UGFzczEpO1xyXG5cdH1cclxuXHJcblx0b25Nb3VzZU1vdmUoZXZlbnQpIHtcclxuXHRcdG1vdXNlLnggPSBldmVudC5jbGllbnRYIC0gd2luZG93SGFsZi54O1xyXG5cdFx0bW91c2UueSA9IGV2ZW50LmNsaWVudFkgLSB3aW5kb3dIYWxmLng7XHJcblx0fVxyXG5cclxuXHRyZW5kZXIoKSB7XHJcblx0XHRyZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy5yZW5kZXIuYmluZCh0aGlzKSk7XHJcblxyXG5cdFx0dGhpcy50aW1lICs9IDAuMDU7XHJcblx0XHR0aGlzLm9zY2lsYXRvciA9IE1hdGguc2luKHRoaXMudGltZSAqIDAuMSkgKiAwLjUgKyAwLjU7XHJcblxyXG5cdFx0cmVuZGVyZXIuc2V0QW5pbWF0aW9uTG9vcCgoKSA9PiB7XHJcblx0XHRcdGN1YmUuZ3JvdXBzLmZvckVhY2goKGl0ZW0pID0+IHtcclxuXHRcdFx0XHR0YXJnZXQueCA9ICgxIC0gbW91c2UueCkgKiAwLjAwMDE1O1xyXG5cdFx0XHRcdHRhcmdldC55ID0gKC01MDAgLSBtb3VzZS55KSAqIDAuMDAwMTQ7XHJcblx0XHRcdFx0aXRlbS5yb3RhdGlvbi54ICs9IDAuMDUgKiAodGFyZ2V0LnkgLSBpdGVtLnJvdGF0aW9uLngpO1xyXG5cdFx0XHRcdGl0ZW0ucm90YXRpb24ueSArPSAwLjA1ICogKHRhcmdldC54IC0gaXRlbS5yb3RhdGlvbi55KTtcclxuXHJcblx0XHRcdFx0aXRlbS5jaGlsZHJlbi5mb3JFYWNoKChtLCBpKSA9PiB7XHJcblx0XHRcdFx0XHRtLnBvc2l0aW9uLnogPSAoaSArIDEpICogMTAwIC0gdGhpcy5vc2NpbGF0b3IgKiAyMDA7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0dGhpcy5jb21wb3Nlci5yZW5kZXIoKTtcclxuXHRcdH0pO1xyXG5cdFx0Ly8gcmVuZGVyZXIucmVuZGVyKHNjZW5lLCBjYW1lcmEpO1xyXG5cdH1cclxuXHJcblx0c3RhcnQoKSB7XHJcblx0XHRsb29wLnN0YXJ0KCk7XHJcblx0fVxyXG5cclxuXHRzdG9wKCkge1xyXG5cdFx0bG9vcC5zdG9wKCk7XHJcblx0fVxyXG59XHJcblxyXG5leHBvcnQgeyBXb3JsZCB9O1xyXG4iXX0=
